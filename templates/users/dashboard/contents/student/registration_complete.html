{% extends "users/dashboard/student_dashboard_layout.html" %}
<!-- --------------------------------------- -->
{% block content %}

<style>
  /* PRINT ONLY REGISTRATION PROOF */
  @media print {
    /* Hide EVERYTHING */
    body * {
      visibility: hidden !important;
    }

    /* Show ONLY the registration proof wrapper */
    .reg-view,
    .reg-view * {
      visibility: visible !important;
    }

    /* Make printed content full width */
    .reg-view {
      position: absolute;
      top: 0;
      left: 0;
      width: 100% !important;
      padding: 20px !important;
      background: white !important;
    }
  }
</style>

<div class="max-w-4xl mx-auto py-4">
  <!-- PAGE HEADER -->
  <div class="flex items-center justify-between mb-8 no-print">
    <h1 class="text-2xl font-extrabold text-slate-800">Registration Proof</h1>

    <!-- ACTION BUTTONS -->
    <div class="flex justify-center gap-4 mt-6 no-print">
      {% if is_registration_open %}
      <a
        href="{% url 'student_manage_courses' %}"
        class="bg-slate-800 text-white px-6 py-3 rounded-xl font-extrabold uppercase tracking-wide text-sm hover:bg-slate-700 transition-colors"
      >
        Manage Courses
      </a>
      {% else %}
      <p class="text-gray-500 text-sm italic py-2">
        Course registration is closed.
      </p>
      {% endif %}

      <button
        onclick="window.print()"
        class="bg-brand-500 text-white px-8 py-2 rounded-xl font-extrabold uppercase tracking-wide text-xs border-b-4 border-brand-700 hover:brightness-110 active:border-b-0 active:translate-y-1 transition-all"
      >
        Print Proof
      </button>
    </div>
  </div>

  <!-- PRINTABLE CARD -->
  <div
    class="reg-view relative bg-white rounded-3xl border-2 border-slate-200 overflow-hidden p-8 md:p-12 print:border-0 print:shadow-none"
  >
    <!-- WATERMARK -->
    <div
      class="absolute inset-0 flex items-center justify-center opacity-[0.03] pointer-events-none select-none"
    >
      <div
        class="w-[420px] h-[420px] border-[36px] border-slate-500 rounded-full flex items-center justify-center"
      >
        <span class="text-8xl font-black">ETI</span>
      </div>
    </div>

    <!-- HEADER -->
    <div
      class="relative flex flex-col md:flex-row items-center justify-between border-b-2 border-slate-600 pb-8 mb-10"
    >
      <div class="flex items-center gap-6 mb-6 md:mb-0">
        <div
          class="w-20 h-20 bg-brand-500 rounded-2xl flex items-center justify-center text-white text-4xl font-black border-b-8 border-brand-700"
        >
          E
        </div>

        <div class="text-center md:text-left">
          <h2 class="text-2xl font-bold text-slate-800 uppercase leading-tight">
            Entrepreneurship Training Institute
          </h2>
          <p class="text-slate-500 font-bold text-sm">
            Academic Affairs Department
          </p>
        </div>
      </div>

      <div class="text-center md:text-right">
        <div class="flex items-center justify-between">
          <div
            class="flex items-center justify-between bg-green-100 text-center md:text-right text-green-700 px-4 py-2 rounded-full font-bold text-xs uppercase tracking-widest"
          >
            <i
              data-lucide="shield-check"
              gap-6
              class="text-green-700 w-6 h-6 stroke-[1.2]"
            ></i>
            Validated Registration
          </div>
        </div>
        <p
          class="mt-2 text-slate-400 font-bold text-xs uppercase tracking-widest"
        >
          {{ semester.name }}
        </p>
      </div>
    </div>

    <!-- STUDENT INFO -->
    <div class="grid grid-cols-1 md:grid-cols-2 gap-8 mb-10 relative">
      <div class="space-y-4">
        <div>
          <div
            class="text-[10px] font-black text-slate-400 uppercase tracking-widest"
          >
            Student Name
          </div>
          <div class="text-lg font-semibold text-slate-600">
            {{ student.get_full_name }}
          </div>
        </div>

        <div>
          <div
            class="text-[10px] font-black text-slate-400 uppercase tracking-widest"
          >
            Registration No.
          </div>
          <div class="text-lg font-semibold text-slate-600 tracking-wider">
            {{ student.username }}
          </div>
        </div>
      </div>

      <div class="space-y-4">
        <div>
          <div
            class="text-[10px] font-black text-slate-400 uppercase tracking-widest"
          >
            Program of Study
          </div>
          <div class="text-lg font-semibold text-slate-600">
            {{ program.name }}
          </div>
        </div>

        <div class="flex gap-8">
          <div>
            <div
              class="text-[10px] font-black text-slate-400 uppercase tracking-widest"
            >
              Academic Year
            </div>
            <div class="text-lg font-semibold text-slate-600">
              {{ semester.academic_year.name }}
            </div>
          </div>

          <div>
            <div
              class="text-[10px] font-black text-slate-400 uppercase tracking-widest"
            >
              Semester
            </div>
            <div class="text-lg font-semibold text-slate-600">
              {{ semester.name }}
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- COURSE TABLE -->
    <div class="mb-10 relative">
      <div
        class="text-xs font-black text-slate-800 uppercase tracking-widest mb-4 bg-slate-50 p-2 rounded-lg inline-block"
      >
        Registered Courses
      </div>

      {% if selected_courses %}
      <div class="overflow-x-auto">
        <table class="w-full text-left table-fixed">
          <thead>
            <tr class="border-b-2 border-slate-200">
              <th
                class="py-4 px-2 text-[10px] font-black text-slate-400 uppercase tracking-widest"
              >
                Code
              </th>
              <th
                class="py-4 px-2 text-[10px] font-black text-slate-400 uppercase tracking-widest"
              >
                Course Title
              </th>
              <th
                class="py-4 px-2 text-[10px] font-black text-slate-400 uppercase tracking-widest"
              >
                Lecturer(s)
              </th>
              <th
                class="py-4 px-2 text-[10px] font-black text-slate-400 uppercase text-right"
              >
                Units
              </th>
            </tr>
          </thead>
          <tbody class="text-slate-800 font-bold">
            {% for row in selected_courses %}
            <tr class="border-b border-slate-100">
              <!-- Course Code -->
              <td class="py-4 px-2 font-black">{{ row.course.course_code }}</td>

              <!-- Course Title -->
              <td class="py-4 px-2">{{ row.course.title }}</td>

              <!-- Lecturers -->
              <td class="py-4 px-2 text-slate-500 italic">
                {% if row.lecturers %} {% for lec in row.lecturers %}
                {{lec.get_full_name }}{% if not forloop.last %}, {% endif %}
                {%endfor %} {% else %} â€” {% endif %}
              </td>

              <!-- Credit Units -->
              <td class="py-4 px-2 text-right">
                {{ row.course.credit_hours }}
              </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
      {% else %}
      <p class="text-slate-500 italic">No courses selected.</p>
      {% endif %}
    </div>

    <!-- FOOTER VALIDATION -->
    <div
      class="grid grid-cols-1 md:grid-cols-2 gap-12 mt-16 pt-12 border-t-2 border-slate-100 border-dashed relative"
    >
      <div>
        <div
          class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-2"
        >
          Verification Notice
        </div>
        <p class="text-xs font-medium text-slate-300 italic leading-relaxed">
          This document is generated electronically and is valid without a
          physical signature. Verification can be done through the ETI Academic
          Affairs office.
        </p>
      </div>

      <div class="text-right">
        <p
          class="text-[10px] font-black text-slate-400 uppercase tracking-widest mb-1"
        >
          Certification
        </p>
        <p class="font-black text-slate-600 italic">Electronically Certified</p>
        <p class="text-[9px] font-bold text-slate-400">
          Generated on {{ semester.updated_at|date:"M d, Y" }}
        </p>
      </div>
    </div>
  </div>
</div>

{% endblock %}
